task:
  id: interactive-jekyll-post-creation
  name: Interactive Jekyll Post Creation
  description: |
    Единая интерактивная задача, которая проводит пользователя через весь процесс создания поста: 
    от извлечения контента до сохранения финального .md файла.
  persona_default: jekyll-post-specialist
  inputs:
    - source: "URL-адрес статьи или путь к локальной папке с контентом."
  output: "Путь к созданному .md файлу в папке _posts."
  steps:
    - "1. **Анализ источника:** Извлечь весь текстовый контент, блоки кода и URL-ы изображений из предоставленного `source`."
    
    - "2. **Интерактивная настройка (Метаданные):**"
    - "   а. Запросить у пользователя дату публикации (формат: YYYY-MM-DD)."
    - "   б. Проанализировать заголовок и предложить 5-10 вариантов для имени файла (slug). **Дождаться выбора пользователя.**"
    - "   в. Проанализировать существующие файлы в `_posts`, чтобы найти серии. Спросить пользователя, является ли статья частью серии, и попросить подтвердить название серии."
    - "   г. Проанализировать существующие теги и категории в блоге, предложить наиболее релевантные на основе контента. **Дождаться подтверждения/редактирования от пользователя.**"

    - "3. **Интерактивная настройка (Опции обработки):**"
    - "   а. Предложить пользователю выбрать один из следующих вариантов работы:"
    - "      - `1:` Только перевести текст на русский язык."
    - "      - `2:` Перевести текст и адаптировать примеры кода на Golang."
    - "      - `3:` Перевести, адаптировать код и улучшить стиль/тон повествования."
    - "      - `4:` Выполнить всё вышеперечисленное и добавить перелинковку (если статья является частью серии)."
    - "   б. **Дождаться выбора пользователя.**"

    - "4. **Обработка контента:** Выполнить действия в соответствии с выбором пользователя на шаге 3, соблюдая следующее **строгое правило**:"
    - "   - **Правило точности:** Перевод должен быть точной и полной передачей смысла исходного текста. **ЗАПРЕЩЕНО:** упускать абзацы или фразы, добавлять информацию 'от себя' (собственные мнения, примеры или комментарии, которых не было в оригинале) или иным образом искажать содержание."

    - "5. **Обработка изображений:**"
    - "   а. Сформировать путь для ассетов: `assets/img/posts/ГГГГ-ММ-ДД-слаг-серии-слаг-статьи/`."
    - "   б. Скачать все изображения из источника."
    - "   в. Сохранить их в созданную папку с именами вида `имя-статьи-1.svg`, `имя-статьи-2.png` и т.д."
    - "   г. Обновить пути к изображениям в обработанном тексте."

    - "6. **Сборка финального файла:**"
    - "   а. Сгенерировать заголовок `front matter` для Jekyll, используя собранные метаданные."
    - "   б. Если выбрана опция перелинковки, найти главный пост серии, скопировать его оглавление, вставить в начало новой статьи и выделить текущую статью."
    - "   в. Объединить заголовок, оглавление (если применимо), обработанный текст и адаптированный код в единый Markdown-документ."

    - "7. **Сохранение:**"
    - "   а. Сформировать имя файла: `ГГГГ-ММ-ДД-слаг.md`."
    - "   б. Сохранить финальный документ в папку `_posts`."
    - "   в. Вернуть пользователю полный путь к созданному файлу."
